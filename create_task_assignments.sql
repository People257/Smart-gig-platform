CREATE TABLE IF NOT EXISTS `task_assignments` (`id` BIGINT NOT NULL AUTO_INCREMENT, `uuid` VARCHAR(36) NOT NULL UNIQUE, `task_application_id` BIGINT NULL UNIQUE, `task_id` BIGINT NOT NULL, `worker_id` BIGINT NOT NULL, `assigned_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, `worker_status` ENUM('working', 'submitted', 'completed', 'quit') NOT NULL DEFAULT 'working', `employer_status` ENUM('in_progress', 'review_pending', 'payment_pending', 'completed', 'disputed') NOT NULL DEFAULT 'in_progress', `completed_at` TIMESTAMP NULL, `updated_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, PRIMARY KEY (`id`), INDEX `idx_task_assignments_uuid` (`uuid`), INDEX `fk_task_assignments_task_id_idx` (`task_id`), INDEX `fk_task_assignments_worker_id_idx` (`worker_id`), CONSTRAINT `fk_task_assignments_application_id` FOREIGN KEY (`task_application_id`) REFERENCES `task_applications` (`id`) ON DELETE SET NULL ON UPDATE NO ACTION, CONSTRAINT `fk_task_assignments_task_id` FOREIGN KEY (`task_id`) REFERENCES `tasks` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION, CONSTRAINT `fk_task_assignments_worker_id` FOREIGN KEY (`worker_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
